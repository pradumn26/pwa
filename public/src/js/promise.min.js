window.setImmediate||function(){"use strict";function n(n){var e=n[0];switch(n.length){case 1:return e();case 2:return e(n[1]);case 3:return e(n[1],n[2])}return e.apply(window,o.call(n,1))}function e(e){var t,i=e.data;"string"==typeof i&&0==i.indexOf(u)&&(t=r[i])&&(delete r[i],n(t))}var t=0,r={},i=!0,o=Array.prototype.slice,u="setImmediatePolyfillMessage";window.setImmediate=function(){for(var n=t++,o=u+n,c=arguments.length,a=new Array(c);c--;)a[c]=arguments[c];return r[o]=a,i&&(i=!1,window.addEventListener("message",e)),window.postMessage(o,"*"),n},window.clearImmediate=function(n){delete r[u+n]}}(),function(n){"use strict";function e(n){this[j]=n}function t(n){return n instanceof e}function r(n){return Object(n)===n}function i(n){return"function"==typeof n}function o(n){return n instanceof p}function u(n){return n}function c(n){throw n}function a(n,e,t){n[g]||(n[g]=[],n[P]=[]),n[g].push(e),n[P].push(t)}function f(n){delete n[g],delete n[P]}function s(n){var e,t=n.length;for(e=0;e<t;e++)n[e]()}function l(n,e,r){var i=d(r);o(i)?i.then(n,e):t(i)?e(i[j]):n(r)}function d(n){var t;if(o(n))return n;if(r(n)){try{t=n.then}catch(n){return new e(n)}if(i(t))return new p(function(e,r){x(function(){try{t.call(n,e,r)}catch(n){r(n)}})})}return null}function h(n,e){function t(e){n[y]==E&&m(n,e)}try{e(function(e){n[y]==E&&w(n,e)},t)}catch(n){t(n)}}function w(n,e){var r,i=d(e);o(i)?(n[y]=I,i.then(function(e){w(n,e)},function(e){m(n,e)})):t(i)?m(n,i[j]):(n[y]=O,n[v]=e,(r=n[g])&&r.length&&(f(n),s(r)))}function m(n,e){var t=n[P];n[y]=b,n[v]=e,t&&t.length&&(f(n),s(t))}function p(n){var e=this;if(!o(e))throw new TypeError(A);e[y]=E,e[v]=void 0,h(e,n)}var y="[[PromiseStatus]]",v="[[PromiseValue]]",g="[[OnFulfilled]]",P="[[OnRejected]]",j="[[OriginalError]]",E="pending",I="internal pending",O="fulfilled",b="rejected",A='constructor Promise requires "new".',T="then() cannot return same Promise that it resolves.",x=n.setImmediate||require("timers").setImmediate,k=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)};p.prototype.then=function(n,e){var t,r=this;return n=i(n)?n:u,e=i(e)?e:c,t=new p(function(i,o){function u(n){var e;try{e=n(r[v])}catch(n){return void o(n)}e===t?o(new TypeError(T)):l(i,o,e)}function c(){x(u,n)}function f(){x(u,e)}switch(r[y]){case O:c();break;case b:f();break;default:a(r,c,f)}})},p.prototype.catch=function(n){return this.then(u,n)},p.resolve=function(n){var e=d(n);return o(e)?e:new p(function(r,i){t(e)?i(e[j]):r(n)})},p.reject=function(n){return new p(function(e,t){t(n)})},p.race=function(n){return new p(function(e,t){var r,i;if(k(n))for(i=n.length,r=0;r<i;r++)l(e,t,n[r]);else t(new TypeError("not an array."))})},p.all=function(n){return new p(function(e,r){var i,u,c,a,f=0,s=0;if(k(n)){for(u=(n=n.slice(0)).length,a=0;a<u;a++)o(i=d(c=n[a]))?(s++,i.then(function(t){return function(r){n[t]=r,++f==s&&e(n)}}(a),r)):t(i)?r(i[j]):n[a]=c;s||e(n)}else r(new TypeError("not an array."))})},"undefined"!=typeof module&&module.exports?module.exports=n.Promise||p:n.Promise||(n.Promise=p)}(this);